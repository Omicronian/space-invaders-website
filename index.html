<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Lrrr - When Aliens Attack 2</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>
    <style>
        body { margin:0; background:#000; overflow:hidden; }
    </style>
</head>
<body>

<!-- Lrrr floating in the corner (pure decoration) -->
<img src="Lrrr2.png" 
     alt="Lrrr - Ruler of Omicron Persei 8" 
     style="position:fixed; top:10px; right:10px; width:140px; height:auto; z-index:9999; pointer-events:none;">

<script>
const config = {
    type: Phaser.AUTO,
    width: 800,
    height: 600,
    backgroundColor: '#000033',
    physics: { default: 'arcade' },
    scene: { preload, create, update }
};

let game = new Phaser.Game(config);
let player, bullets, cursors, score = 0, scoreText, titleText;

function preload() {
    this.load.image('ship', 'https://labs.phaser.io/assets/sprites/ship.png');
    this.load.image('bullet', 'https://labs.phaser.io/assets/sprites/bullet.png');
    this.load.image('invader', 'https://labs.phaser.io/assets/sprites/spaceInvaders.png');
}

function create() {
    // Epic Futurama-style title
    titleText = this.add.text(400, 80, 'Lrrr\nWhen Aliens Attack 2', {
        font: '48px Arial Black',
        fill: '#ff0044',
        align: 'center',
        stroke: '#00ff00',
        strokeThickness: 6
    }).setOrigin(0.5).setDepth(10);

    this.add.text(400, 140, 'Ruler of Omicron Persei 8 demands entertainment!', {
        font: '20px Courier New',
        fill: '#00ff00'
    }).setOrigin(0.5);

    // Player ship
    player = this.physics.add.sprite(400, 550, 'ship').setScale(1.8);
    player.setCollideWorldBounds(true);

    // Bullet group
    bullets = this.physics.add.group();

    // Just for visual targets — no links anymore!
    let invaders = this.physics.add.group();
    for (let row = 0; row < 4; row++) {
        for (let col = 0; col < 8; col++) {
            let x = 100 + col * 80;
            let y = 200 + row * 70;
            invaders.create(x, y, 'invader').setScale(1.8);
        }
    }

    // Controls
    cursors = this.input.keyboard.createCursorKeys();
    this.input.keyboard.on('keydown-SPACE', shoot);

    // Score & instructions
    scoreText = this.add.text(10, 10, 'Score: 0', {
        font: '20px Courier New', fill: '#00ff00'
    }).setDepth(10);

    this.add.text(10, 40, '← → Move    SPACE Shoot    Destroy the fleet!', {
        font: '16px Courier New', fill: '#00ff88'
    });
}

function update() {
    // Player movement
    player.setVelocityX(0);
    if (cursors.left.isDown) player.setVelocityX(-400);
    if (cursors.right.isDown) player.setVelocityX(400);
}

function shoot() {
    if (bullets.countActive() < 5) {
        let bullet = bullets.create(player.x, player.y - 30, 'bullet');
        bullet.setVelocityY(-700);
        bullet.checkWorldBounds = true;
        bullet.outOfBoundsKill = true;
    }

    // Collision: bullet hits any invader
    game.scene.scenes[0].physics.overlap(bullets, game.scene.scenes[0].children.list.filter(c => c.texture && c.texture.key === 'invader'), (bullet, invader) => {
        // Explosion effect
        let boom = game.scene.scenes[0].add.circle(invader.x, invader.y, 5, 0xff0000);
        game.scene.scenes[0].tweens.add({
            targets: boom,
            radius: 60,
            alpha: 0,
            duration: 400,
            onComplete: () => boom.destroy()
        });

        bullet.destroy();
        invader.destroy();

        score += 10;
        scoreText.setText('Score: ' + score);

        // Victory message when all are destroyed
        if (game.scene.scenes[0].children.list.filter(c => c.texture && c.texture.key === 'invader').length === 1) {
            game.scene.scenes[0].add.text(400, 300, 'HUMANS WIN... FOR NOW!', {
                font: '40px Arial Black',
                fill: '#ff0000',
                stroke: '#ffffff',
                strokeThickness: 8
            }).setOrigin(0.5).setDepth(20);
        }
    });
}
</script>

</body>
</html>
